---
title: "DMCLARK_HW2"
output: 
  flexdashboard::flex_dashboard:
   orientation: rows
   vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
#library(flexdashboard)
library(shiny)
library(ggplot2)
library(dplyr)
library(readr)
#install.packages(ECharts2Shiny)
library(ECharts2Shiny)
library(plotly)


dataset <- read_csv("US Police shootings in from 2015-22_alt_race.csv")
```



Row 
--------------------------------------
## Chart 1 Whisker Plot Highlighting mean age based off select-able race

```{r}
data_subset <- reactive({
  dataset %>%
    filter(
      race %in% input$race
    )
})

# Render the plot 

checkboxGroupInput("race", "Race", choices = c("Asian","Black", "Hispanic", "Non-His / Lat", "Other", "Pacific Islander", "White"),
                   selected = c("Asian","Black", "Hispanic", "Non-His / Lat", "Other", "Pacific Islander", "White"), inline = TRUE)
renderPlot({
  ggplot(data_subset(), aes(x = race, y = age, color = factor(race))) +
    geom_boxplot()
  
})
#Code is in good working order, I may need to change the display for better visuals 
```
Row {.tabset .tabset-fade}
## Chart 2 Number of Victums Armed at the time of Incident
```{r}
#Isolate and get the count of victims armed at the time of shooting

dataset_armed <- dataset %>%
  mutate(armed = ifelse(is.na(armed),0,ifelse(armed == "Yes",1,0))) %>%
  na.omit()

sum_armed_by_race <- dataset_armed %>%
  group_by(race) %>%
  summarize(sum_armed = sum(armed))

selectInput("filter_variable", "Filter by:", 
            choices = c("Asian","Black", "Hispanic", "Non-His / Lat", "Other", "Pacific Islander", "White"), 
            selected = c("Asian","Black", "Hispanic", "Non-His / Lat", "Other", "Pacific Islander", "White"))

renderPlot({
  filtered_data <- dataset_armed %>%
    filter(race == input$filter_variable)

  ggplot(filtered_data, aes(x = race, y = armed)) +
    geom_col(fill = "blue") +
    ylab("Number of Armed People") +
    ggtitle(paste("Number of Armed People by Race:", input$filter_variable))
})



```

## Chart 3 Select race to filter by state 
```{r}

data_subset <- reactive({
  dataset %>%
    filter(
      state %in% input$state
    )
})
selectInput("state", "Select State(s):", 
            choices = unique(dataset$state), 
            selected = unique(dataset$state),
            multiple = TRUE)

renderPlot({
  filtered_data <- data_subset() %>%
    filter(filter_variable == input$filter_variable)
    
ggplot(filtered_data, aes(x = filter_variable, y = state)) +
    geom_point()
})
```

## Chart 4
```{r}
# Create a data frame
data <- data.frame(
  age = sample(2:92, 100, replace = TRUE),
  filter_variable = sample(c("Asian","Black", "Hispanic", "Non-His / Lat", "Other", "Pacific Islander", "White"), 100, replace = TRUE)
)

# Create the plot
plot <- plot_ly(data, x = ~age, y = ~filter_variable, type = 'scatter', mode = 'markers')

# Display the plot
plotlyOutput(plot)
```
